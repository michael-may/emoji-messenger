"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8408],{8408:(x,f,r)=>{r.r(f),r.d(f,{SettingsPageModule:()=>p});var T=r(9808),b=r(4030),_=r(4182),k=r(4466),d=r(655),S=r(8790),w=r(9278),U=r(8115),v=r(7714),e=r(9863),n=r(5362);function I(c,o){1&c&&e._UZ(0,"ion-spinner",18)}function P(c,o){1&c&&e._UZ(0,"ion-icon",19)}function C(c,o){if(1&c){const t=e.EpF();e.TgZ(0,"ion-button",20),e.NdJ("click",function(){return e.CHM(t),e.MAs(5).click()}),e._UZ(1,"ion-icon",21),e.TgZ(2,"ion-label"),e._uU(3,"Select File"),e.qZA(),e.TgZ(4,"input",22,23),e.NdJ("change",function(s){return e.CHM(t),e.oxw().import(s)}),e.qZA(),e.qZA()}}function F(c,o){1&c&&e._UZ(0,"ion-spinner",24)}class u{constructor(o,t,i,s){this.keyService=o,this.contactService=t,this.conversationService=i,this.toastController=s,this.processingBackup=!1,this.processingFile=!1}ngOnDestroy(){}export(){var o,t,i;return(0,d.mG)(this,void 0,void 0,function*(){this.processingBackup=!0;const s=window.prompt("Enter a password for this backup (or leave blank).");let g=null!==(o=localStorage.getItem("encryptionKeys"))&&void 0!==o?o:"",h=null!==(t=localStorage.getItem("contacts"))&&void 0!==t?t:"",y=null!==(i=localStorage.getItem("conversations"))&&void 0!==i?i:"";const Z=JSON.stringify({encryptionKeys:g,contacts:h,conversations:y}),l=yield v.w.passwordEncrypt(Z,s).catch(q=>(console.log(q),null));if(!l)return(yield this.toastController.create({message:"Error encrypting backup.",duration:2e3})).present(),void(this.processingBackup=!1);const A=new Blob([l],{type:"application/messengerbackup"}),a=URL.createObjectURL(A);this.processingBackup=!1;var m=document.createElement("a");m.href=a,m.download=`${Date.now()}.messengerbackup`,m.click()})}import(o){var t,i,s;return(0,d.mG)(this,void 0,void 0,function*(){if(!(null===(t=o.target.files)||void 0===t?void 0:t.length))return;this.processingFile=!0;let g=null===(s=null===(i=null==o?void 0:o.target)||void 0===i?void 0:i.files)||void 0===s?void 0:s[0];if(!g)return(yield this.toastController.create({message:"Error loading file.",duration:2e3})).present(),void(this.processingFile=!1);const h=yield this.loadFile(g).catch(a=>(console.log(a),null));if(!h)return(yield this.toastController.create({message:"Error parsing file.",duration:2e3})).present(),void(this.processingFile=!1);const y=window.prompt("Enter the password for this backup (or leave blank if none)."),Z=yield v.w.passwordDecrypt(h,y).catch(a=>(console.log(a),null));if(!Z)return(yield this.toastController.create({message:"Error decrypting backup. Maybe wrong password?",duration:2e3})).present(),void(this.processingFile=!1);let l;try{l=JSON.parse(Z)}catch(a){return(yield this.toastController.create({message:"Error parsing backup. Probably corrupted.",duration:2e3})).present(),void(this.processingFile=!1)}l.encryptionKeys&&(localStorage.setItem("encryptionKeys",l.encryptionKeys),yield this.keyService.loadKeys().catch(a=>{console.log(a)})),l.contacts&&(localStorage.setItem("contacts",l.contacts),yield this.contactService.loadContacts().catch(a=>{console.log(a)})),l.conversations&&(localStorage.setItem("conversations",l.conversations),yield this.conversationService.loadConversations().catch(a=>{console.log(a)})),this.processingFile=!1,(yield this.toastController.create({message:"Import complete!",duration:2e3})).present()})}deleteData(){return(0,d.mG)(this,void 0,void 0,function*(){window.confirm("Are you absolutely sure? This is unrecoverable without a backup.")&&(localStorage.clear(),yield this.keyService.loadKeys().catch(t=>{console.log(t)}),yield this.contactService.loadContacts().catch(t=>{console.log(t)}),yield this.conversationService.loadConversations().catch(t=>{console.log(t)}))})}loadFile(o){return(0,d.mG)(this,void 0,void 0,function*(){return new Promise((t,i)=>{const s=new FileReader;s.onloadend=()=>t(s.result),s.onerror=g=>i(g),s.readAsText(o)})})}}u.\u0275fac=function(o){return new(o||u)(e.Y36(U.BA),e.Y36(S.yq),e.Y36(w.EA),e.Y36(n.yF))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-settings"]],decls:87,vars:6,consts:[["translucent","true"],["color","primary"],[3,"disabled","click"],["slot","start",4,"ngIf"],["name","download-outline","slot","start",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end",4,"ngIf"],["color","danger",3,"click"],["name","trash-outline","slot","start"],[3,"multiple"],["value","q1"],["slot","header"],["slot","content"],["value","q2"],["value","q3"],["value","q4"],["href","https://github.com/michael-may/emoji-messenger","target","_blank"],["value","q5"],["slot","start"],["name","download-outline","slot","start"],[3,"click"],["slot","start","name","folder-outline"],["type","file","accept",".messengerbackup","slot","end",1,"ion-hide",3,"change"],["input",""],["slot","end"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-header",0),e.TgZ(1,"ion-toolbar",1),e.TgZ(2,"ion-title"),e._uU(3," Settings "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(4,"ion-content"),e.TgZ(5,"ion-list"),e.TgZ(6,"ion-list-header"),e._uU(7," Your Data "),e.qZA(),e.TgZ(8,"ion-item"),e.TgZ(9,"ion-label"),e._uU(10," Export: "),e.qZA(),e.TgZ(11,"ion-button",2),e.NdJ("click",function(){return t.export()}),e.YNc(12,I,1,0,"ion-spinner",3),e.YNc(13,P,1,0,"ion-icon",4),e.TgZ(14,"ion-label"),e._uU(15,"Download"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"ion-item"),e.TgZ(17,"ion-label"),e._uU(18," Import Backup: "),e.qZA(),e.YNc(19,C,6,0,"ion-button",5),e.YNc(20,F,1,0,"ion-spinner",6),e.qZA(),e.TgZ(21,"ion-item"),e.TgZ(22,"ion-label"),e._uU(23," Delete: "),e.qZA(),e.TgZ(24,"ion-button",7),e.NdJ("click",function(){return t.deleteData()}),e._UZ(25,"ion-icon",8),e.TgZ(26,"ion-label"),e._uU(27,"Delete All Data"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"ion-list-header"),e._uU(29," Help "),e.qZA(),e.TgZ(30,"ion-accordion-group",9),e.TgZ(31,"ion-accordion",10),e.TgZ(32,"ion-item",11),e.TgZ(33,"p"),e._uU(34,"Why won't my imported messages won't load?"),e.qZA(),e.qZA(),e.TgZ(35,"ion-list",12),e.TgZ(36,"p"),e._uU(37," If you used the image share feature, there's a chance the application you shared to doesn't support transparency or .png files. "),e.qZA(),e.TgZ(38,"p"),e._uU(39," Try resending the message as a QR code for better compatibility. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(40,"ion-accordion",13),e.TgZ(41,"ion-item",11),e.TgZ(42,"p"),e._uU(43,"Why can't I read messages I've sent to other people?"),e.qZA(),e.qZA(),e.TgZ(44,"ion-list",12),e.TgZ(45,"p"),e._uU(46," Messages sent to other people are encrypted with their public key and are only decryptable with their private key. Since you (hopefully) don't have their private key, you can't read messages you've sent to them. "),e.qZA(),e.TgZ(47,"p"),e._uU(48," A future update may add the option to save a copy of the message signed with your own key for reference. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(49,"ion-accordion",14),e.TgZ(50,"ion-item",11),e.TgZ(51,"p"),e._uU(52,"Why can my messages only contain 382 characters? That seems oddly specific."),e.qZA(),e.qZA(),e.TgZ(53,"ion-list",12),e.TgZ(54,"p"),e._uU(55," While the output of the message encryption algorithm is 512 bytes long, some of the space is taken up by the message hash. "),e.qZA(),e.TgZ(56,"p"),e._uU(57," Messages are encrypted with RSA Optimal Asymmetric Encryption Padding (OAEP) using an SHA-512 hash and an RSA 4096 key. The maximum length of your message is the total size (512 bytes) minus the hash overhead (130 bytes). This leaves 382 bytes for your message. "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(58,"ion-accordion",15),e.TgZ(59,"ion-item",11),e.TgZ(60,"p"),e._uU(61,"Is there a native app available?"),e.qZA(),e.qZA(),e.TgZ(62,"ion-list",12),e.TgZ(63,"p"),e._uU(64," No. This application is intended to be completely open and unrestricted. "),e.qZA(),e.TgZ(65,"p"),e._uU(66," The project is built with Angular and Ionic and could be converted to Capacitor application pretty easily. "),e.qZA(),e.TgZ(67,"p"),e.TgZ(68,"a",16),e._uU(69,"Fork and hack away."),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(70,"ion-accordion",17),e.TgZ(71,"ion-item",11),e.TgZ(72,"p"),e._uU(73,"Can I host my own instance?"),e.qZA(),e.qZA(),e.TgZ(74,"ion-list",12),e.TgZ(75,"p"),e._uU(76," Feel free to host your own instance! The source code is "),e.TgZ(77,"a",16),e._uU(78,"here"),e.qZA(),e._uU(79,". "),e.qZA(),e.TgZ(80,"p"),e._uU(81," As long as you don't mess with the encryption or image generation functions, your instance should be compatible with any other, similar instance. "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(82,"ion-footer"),e.TgZ(83,"ion-toolbar"),e.TgZ(84,"ion-grid"),e.TgZ(85,"ion-row"),e._UZ(86,"ion-col"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(11),e.Q6J("disabled",t.processingBackup),e.xp6(1),e.Q6J("ngIf",t.processingBackup),e.xp6(1),e.Q6J("ngIf",!t.processingBackup),e.xp6(6),e.Q6J("ngIf",!t.processingFile),e.xp6(1),e.Q6J("ngIf",t.processingFile),e.xp6(10),e.Q6J("multiple",!0))},directives:[n.Gu,n.sr,n.wd,n.W2,n.q_,n.yh,n.Ie,n.Q$,n.YG,T.O5,n.gu,n.eh,n.We,n.fr,n.jY,n.Nd,n.wI,n.PQ],styles:[".full-width[_ngcontent-%COMP%]{width:100%}ion-accordion[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:400px;margin:16px}"]});class p{}p.\u0275fac=function(o){return new(o||p)},p.\u0275mod=e.oAB({type:p}),p.\u0275inj=e.cJS({imports:[[T.ez,b.Bz.forChild([{path:"",component:u}]),_.UX,k.m]]})}}]);