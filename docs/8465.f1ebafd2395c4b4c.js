"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8465],{8465:(E,h,a)=>{a.r(h),a.d(h,{HomePageModule:()=>_});var v=a(9808),C=a(4992),r=a(4182),k=a(4466),g=a(655),p=a(4850),T=a(2868),A=a(9278),y=a(8115),x=a(8790),q=a(6817),N=a(5340),n=a(2096),i=a(5362);function U(e,t){if(1&e&&(n.TgZ(0,"ion-select-option",12),n._uU(1),n.qZA()),2&e){const o=t.$implicit;n.s9C("value",o.id),n.xp6(1),n.hij(" ",o.name," ")}}function I(e,t){if(1&e){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," To: "),n.qZA(),n.TgZ(3,"ion-select",10),n.NdJ("ionChange",function(l){return n.CHM(o),n.oxw(2).updateTo(l)}),n.YNc(4,U,2,2,"ion-select-option",11),n.qZA(),n.BQk()}if(2&e){const o=n.oxw().ngIf;n.xp6(4),n.Q6J("ngForOf",o)}}function M(e,t){if(1&e){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," No saved contacts "),n.qZA(),n.TgZ(3,"ion-button",3),n.NdJ("click",function(){return n.CHM(o),n.oxw(2).addContact()}),n._uU(4,"Add Contact"),n.qZA(),n.BQk()}}function b(e,t){if(1&e&&(n.TgZ(0,"ion-item"),n.YNc(1,I,5,1,"ng-container",8),n.YNc(2,M,5,0,"ng-container",8),n.qZA()),2&e){const o=t.ngIf;n.xp6(1),n.Q6J("ngIf",o.length),n.xp6(1),n.Q6J("ngIf",!o.length)}}function J(e,t){if(1&e&&(n.TgZ(0,"ion-select-option",12),n._uU(1),n.qZA()),2&e){const o=t.$implicit;n.Q6J("value",o.id),n.xp6(1),n.hij(" ",o.name," ")}}function w(e,t){if(1&e){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," From: "),n.qZA(),n.TgZ(3,"ion-select",13),n.NdJ("ionChange",function(l){return n.CHM(o),n.oxw(2).updateFrom(l)}),n.YNc(4,J,2,2,"ion-select-option",11),n.qZA(),n.BQk()}if(2&e){const o=n.oxw().ngIf;n.xp6(4),n.Q6J("ngForOf",o)}}function F(e,t){if(1&e){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," No saved keys "),n.qZA(),n.TgZ(3,"ion-button",3),n.NdJ("click",function(){return n.CHM(o),n.oxw(2).createKey()}),n._uU(4,"Create Key"),n.qZA(),n.BQk()}}function Y(e,t){if(1&e&&(n.TgZ(0,"ion-item"),n.YNc(1,w,5,1,"ng-container",8),n.YNc(2,F,5,0,"ng-container",8),n.qZA()),2&e){const o=t.ngIf;n.xp6(1),n.Q6J("ngIf",o.length),n.xp6(1),n.Q6J("ngIf",!o.length)}}class f{constructor(t,o,c,l,d){this.conversationService=t,this.keyService=o,this.contactService=c,this.modalController=l,this.elementRef=d,this.contacts$=this.contactService.contacts$.pipe((0,p.U)(s=>s.sort((m,u)=>m.created-u.created))),this.keys$=this.keyService.keys$.pipe((0,p.U)(s=>s.sort((m,u)=>m.created-u.created))),this.newConversationForm=new r.cw({name:new r.NI("",r.kI.required),to:new r.NI("",r.kI.required),from:new r.NI("",r.kI.required)}),this.saving=!1}addContact(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:q.S,swipeToClose:!0,presentingElement:this.elementRef.nativeElement})).present()})}createKey(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:N.K,swipeToClose:!0,presentingElement:this.elementRef.nativeElement})).present()})}saveConversation(){return(0,g.mG)(this,void 0,void 0,function*(){if(this.saving)return;this.saving=!0;const t=this.newConversationForm.get("name").value,o=this.newConversationForm.get("to").value,c=this.newConversationForm.get("from").value,l=yield this.conversationService.addConversation(t,o,c).catch(d=>(console.log(d),null));if(this.saving=!1,!l)throw new Error("Couldn't create conversation.");this.dismiss()})}updateTo(t){var o;this.newConversationForm.patchValue({to:null===(o=t.detail)||void 0===o?void 0:o.value})}updateFrom(t){var o;this.newConversationForm.patchValue({from:null===(o=t.detail)||void 0===o?void 0:o.value})}dismiss(){this.modalController.dismiss()}}f.\u0275fac=function(t){return new(t||f)(n.Y36(A.EA),n.Y36(y.BA),n.Y36(x.yq),n.Y36(i.IN),n.Y36(n.SBq))},f.\u0275cmp=n.Xpm({type:f,selectors:[["app-conversation-add"]],decls:21,vars:8,consts:[["translucent","true"],["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup"],["position","floating"],["formControlName","name","ngDefaultControl","","placeholder","Name","type","text"],[4,"ngIf"],["expand","block",3,"disabled","click"],["formControlName","to","ngDefaultControl","","placeholder","Select a Contact",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","from","ngDefaultControl","","placeholder","Select a Key",3,"ionChange"]],template:function(t,o){1&t&&(n.TgZ(0,"ion-header",0),n.TgZ(1,"ion-toolbar",1),n.TgZ(2,"ion-title"),n._uU(3," Create new Conversation "),n.qZA(),n.TgZ(4,"ion-buttons",2),n.TgZ(5,"ion-button",3),n.NdJ("click",function(){return o.dismiss()}),n._UZ(6,"ion-icon",4),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(7,"ion-content"),n.TgZ(8,"form",5),n.TgZ(9,"ion-item"),n.TgZ(10,"ion-label",6),n._uU(11," Conversation Name "),n.qZA(),n._UZ(12,"ion-input",7),n.qZA(),n.YNc(13,b,3,2,"ion-item",8),n.ALo(14,"async"),n.YNc(15,Y,3,2,"ion-item",8),n.ALo(16,"async"),n.qZA(),n.qZA(),n.TgZ(17,"ion-footer"),n.TgZ(18,"ion-toolbar"),n.TgZ(19,"ion-button",9),n.NdJ("click",function(){return o.saveConversation()}),n._uU(20,"Save"),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(8),n.Q6J("formGroup",o.newConversationForm),n.xp6(5),n.Q6J("ngIf",n.lcZ(14,4,o.contacts$)),n.xp6(2),n.Q6J("ngIf",n.lcZ(16,6,o.keys$)),n.xp6(4),n.Q6J("disabled",!o.newConversationForm.valid))},directives:[i.Gu,i.sr,i.wd,i.Sm,i.YG,i.gu,i.W2,r._Y,r.JL,r.sg,i.Ie,i.Q$,i.pK,i.j9,r.JJ,r.u,r.Fj,v.O5,i.fr,i.t9,i.QI,v.sg,i.n0],pipes:[v.Ov],styles:[""]});const Q=function(e){return["/conversations",e]};function S(e,t){if(1&e){const o=n.EpF();n.TgZ(0,"ion-item"),n.TgZ(1,"div",9),n.TgZ(2,"div",10),n._uU(3),n.qZA(),n.TgZ(4,"div",11),n.TgZ(5,"ion-button",12),n.NdJ("click",function(){const d=n.CHM(o).$implicit;return n.oxw(2).deleteConversation(d.id)}),n._UZ(6,"ion-icon",13),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&e){const o=t.$implicit;n.xp6(2),n.Q6J("routerLink",n.VKq(2,Q,o.id)),n.xp6(1),n.hij(" ",o.name," ")}}const $=function(){return["/keys"]},H=function(){return["/contacts"]};function P(e,t){1&e&&(n.TgZ(0,"div",14),n.TgZ(1,"h2"),n._uU(2,"No Conversations"),n.qZA(),n.TgZ(3,"p"),n._uU(4," Conversations store encrypted exchanges between your contacts and any of your keys. "),n.qZA(),n.TgZ(5,"p"),n._uU(6," To get started, you'll want to make sure you've generated at least one key, and shared it with anyone you want to exchange messages with. "),n.qZA(),n.TgZ(7,"p"),n._uU(8," If you haven't generated any keys:"),n._UZ(9,"br"),n.TgZ(10,"ion-button",15),n._uU(11,"Generate Keys"),n.qZA(),n.qZA(),n.TgZ(12,"p"),n._uU(13," If you haven't added any contacts:"),n._UZ(14,"br"),n.TgZ(15,"ion-button",15),n._uU(16,"Add Contacts"),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(10),n.Q6J("routerLink",n.DdM(2,$)),n.xp6(5),n.Q6J("routerLink",n.DdM(3,H)))}function O(e,t){if(1&e&&(n.TgZ(0,"div",5),n.TgZ(1,"ion-list",6),n.YNc(2,S,7,4,"ion-item",7),n.qZA(),n.YNc(3,P,17,4,"div",8),n.qZA()),2&e){const o=t.ngIf;n.xp6(2),n.Q6J("ngForOf",o),n.xp6(1),n.Q6J("ngIf",!o.length)}}class Z{constructor(t,o,c,l,d){this.keyService=t,this.conversationService=o,this.contactService=c,this.modalController=l,this.routerOutlet=d,this.contacts$=this.contactService.contacts$.pipe((0,p.U)(s=>s.sort((m,u)=>m.created-u.created)),(0,T.b)(s=>this.contacts=s)),this.keys$=this.keyService.keys$.pipe((0,p.U)(s=>s.sort((m,u)=>m.created-u.created)),(0,T.b)(s=>this.keys=s)),this.conversations$=this.conversationService.conversations$.pipe((0,p.U)(s=>s.sort((m,u)=>m.created-u.created))),this.keys=[],this.contacts=[]}addConversation(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:f,swipeToClose:!0,presentingElement:this.routerOutlet.nativeEl})).present()})}deleteConversation(t){return(0,g.mG)(this,void 0,void 0,function*(){window.confirm("Are you absolutely sure? This is unrecoverable.")&&this.conversationService.deleteConversation(t)})}}Z.\u0275fac=function(t){return new(t||Z)(n.Y36(y.BA),n.Y36(A.EA),n.Y36(x.yq),n.Y36(i.IN),n.Y36(i.jP))},Z.\u0275cmp=n.Xpm({type:Z,selectors:[["app-home"]],decls:13,vars:3,consts:[["translucent","true"],["color","primary"],["class","conversations",4,"ngIf"],["expand","block",3,"click"],["name","add-circle-outline","slot","start"],[1,"conversations"],[1,"conversation-list"],[4,"ngFor","ngForOf"],["class","conversation-fallback",4,"ngIf"],[1,"conversation-item"],[1,"conversation-name",3,"routerLink"],[1,"buttons"],[3,"click"],["name","trash-outline"],[1,"conversation-fallback"],[3,"routerLink"]],template:function(t,o){1&t&&(n.TgZ(0,"ion-header",0),n.TgZ(1,"ion-toolbar",1),n.TgZ(2,"ion-title"),n._uU(3," Conversations "),n.qZA(),n.qZA(),n.qZA(),n.TgZ(4,"ion-content"),n.YNc(5,O,4,2,"div",2),n.ALo(6,"async"),n.qZA(),n.TgZ(7,"ion-footer"),n.TgZ(8,"ion-toolbar"),n.TgZ(9,"ion-button",3),n.NdJ("click",function(){return o.addConversation()}),n._UZ(10,"ion-icon",4),n.TgZ(11,"ion-label"),n._uU(12,"Start New Conversation"),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(5),n.Q6J("ngIf",n.lcZ(6,1,o.conversations$)))},directives:[i.Gu,i.sr,i.wd,i.W2,v.O5,i.fr,i.YG,i.gu,i.Q$,i.q_,v.sg,i.Ie,C.rH,i.YI],pipes:[v.Ov],styles:[".conversation-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.conversation-item[_ngcontent-%COMP%]   .conversation-name[_ngcontent-%COMP%]{flex:1;padding-top:10px;padding-bottom:10px;cursor:pointer}.conversation-fallback[_ngcontent-%COMP%]{margin:10px}"]});class _{}_.\u0275fac=function(t){return new(t||_)},_.\u0275mod=n.oAB({type:_}),_.\u0275inj=n.cJS({imports:[[v.ez,C.Bz.forChild([{path:"",component:Z}]),r.u5,k.m]]})}}]);