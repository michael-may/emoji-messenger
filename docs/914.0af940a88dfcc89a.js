"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[914],{914:(N,p,r)=>{r.r(p),r.d(p,{HomePageModule:()=>g});var _=r(1368),h=r(2324),l=r(4716),O=r(9280),m=r(1528),y=r(4704),k=r(1220),I=r(1876),G=r(9252),$=r(4336),E=r(3889),n=r(4496),i=r(2112);function R(e,o){if(1&e&&(n.I0R(0,"ion-select-option",13),n.OEk(1),n.C$Y()),2&e){const t=o.$implicit;n._6D("value",t.id),n.yG2(),n.oRS(" ",t.name," ")}}function Y(e,o){if(1&e){const t=n.KQA();n.SAx(0),n.I0R(1,"ion-label"),n.OEk(2," To: "),n.C$Y(),n.I0R(3,"ion-select",11),n.qCj("ionChange",function(s){n.usT(t);const c=n.GaO(2);return n.CGJ(c.updateTo(s))}),n.yuY(4,R,2,2,"ion-select-option",12),n.C$Y(),n.k70()}if(2&e){const t=n.GaO().ngIf;n.yG2(4),n.E7m("ngForOf",t)}}function M(e,o){if(1&e){const t=n.KQA();n.SAx(0),n.I0R(1,"ion-label"),n.OEk(2," No saved contacts "),n.C$Y(),n.I0R(3,"ion-button",3),n.qCj("click",function(){n.usT(t);const s=n.GaO(2);return n.CGJ(s.addContact())}),n.OEk(4,"Add Contact"),n.C$Y(),n.k70()}}function w(e,o){if(1&e&&(n.I0R(0,"ion-item"),n.yuY(1,Y,5,1,"ng-container",8)(2,M,5,0,"ng-container",8),n.C$Y()),2&e){const t=o.ngIf;n.yG2(),n.E7m("ngIf",t.length),n.yG2(),n.E7m("ngIf",!t.length)}}function T(e,o){if(1&e&&(n.I0R(0,"ion-select-option",13),n.OEk(1),n.C$Y()),2&e){const t=o.$implicit;n.E7m("value",t.id),n.yG2(),n.oRS(" ",t.name," ")}}function x(e,o){if(1&e){const t=n.KQA();n.SAx(0),n.I0R(1,"ion-label"),n.OEk(2," From: "),n.C$Y(),n.I0R(3,"ion-select",14),n.qCj("ionChange",function(s){n.usT(t);const c=n.GaO(2);return n.CGJ(c.updateFrom(s))}),n.yuY(4,T,2,2,"ion-select-option",12),n.C$Y(),n.k70()}if(2&e){const t=n.GaO().ngIf;n.yG2(4),n.E7m("ngForOf",t)}}function b(e,o){if(1&e){const t=n.KQA();n.SAx(0),n.I0R(1,"ion-label"),n.OEk(2," No saved keys "),n.C$Y(),n.I0R(3,"ion-button",3),n.qCj("click",function(){n.usT(t);const s=n.GaO(2);return n.CGJ(s.createKey())}),n.OEk(4,"Create Key"),n.C$Y(),n.k70()}}function A(e,o){if(1&e&&(n.I0R(0,"ion-item"),n.yuY(1,x,5,1,"ng-container",8)(2,b,5,0,"ng-container",8),n.C$Y()),2&e){const t=o.ngIf;n.yG2(),n.E7m("ngIf",t.length),n.yG2(),n.E7m("ngIf",!t.length)}}class f{constructor(o,t,a,s,c){this.conversationService=o,this.keyService=t,this.contactService=a,this.modalController=s,this.elementRef=c,this.contacts$=this.contactService.contacts$.pipe((0,y.k)(d=>d.sort((u,v)=>u.created-v.created))),this.keys$=this.keyService.keys$.pipe((0,y.k)(d=>d.sort((u,v)=>u.created-v.created))),this.newConversationForm=new l.k1({name:new l.yM("",l.AQ.required),to:new l.yM("",l.AQ.required),from:new l.yM("",l.AQ.required)}),this.saving=!1}addContact(){var o=this;return(0,m.c)(function*(){var a;yield(yield o.modalController.create({component:$.m,canDismiss:(a=(0,m.c)(function*(s,c){return"gesture"!==c}),function(c,d){return a.apply(this,arguments)}),presentingElement:o.elementRef.nativeElement})).present()})()}createKey(){var o=this;return(0,m.c)(function*(){var a;yield(yield o.modalController.create({component:E._,canDismiss:(a=(0,m.c)(function*(s,c){return"gesture"!==c}),function(c,d){return a.apply(this,arguments)}),presentingElement:o.elementRef.nativeElement})).present()})()}saveConversation(){var o=this;return(0,m.c)(function*(){if(o.saving)return;o.saving=!0;const t=o.newConversationForm.get("name").value,a=o.newConversationForm.get("to").value,s=o.newConversationForm.get("from").value,c=yield o.conversationService.addConversation(t,a,s).catch(d=>(console.log(d),null));if(o.saving=!1,!c)throw new Error("Couldn't create conversation.");o.dismiss()})()}updateTo(o){this.newConversationForm.patchValue({to:o.detail?.value})}updateFrom(o){this.newConversationForm.patchValue({from:o.detail?.value})}dismiss(){this.modalController.dismiss()}static#n=this.\u0275fac=function(t){return new(t||f)(n.GI1(k.eC),n.GI1(I.qk),n.GI1(G.gH),n.GI1(i.qS),n.GI1(n.GMv))};static#t=this.\u0275cmp=n.In1({type:f,selectors:[["app-conversation-add"]],decls:26,vars:8,consts:[["translucent","true"],["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup"],["position","floating"],["formControlName","name","ngDefaultControl","","placeholder","Name","type","text"],[4,"ngIf"],["expand","block",3,"disabled","click"],["name","save-outline","slot","start"],["formControlName","to","ngDefaultControl","","placeholder","Select a Contact",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","from","ngDefaultControl","","placeholder","Select a Key",3,"ionChange"]],template:function(t,a){1&t&&(n.I0R(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),n.OEk(3," Create new Conversation "),n.C$Y(),n.I0R(4,"ion-buttons",2)(5,"ion-button",3),n.qCj("click",function(){return a.dismiss()}),n.wR5(6,"ion-icon",4),n.C$Y()()()(),n.I0R(7,"ion-content")(8,"form",5)(9,"ion-item")(10,"ion-label",6),n.OEk(11," Conversation Name "),n.C$Y(),n.wR5(12,"ion-input",7),n.C$Y(),n.yuY(13,w,3,2,"ion-item",8),n.wVc(14,"async"),n.yuY(15,A,3,2,"ion-item",8),n.wVc(16,"async"),n.C$Y()(),n.I0R(17,"ion-footer")(18,"ion-toolbar")(19,"ion-grid")(20,"ion-row")(21,"ion-col")(22,"ion-button",9),n.qCj("click",function(){return a.saveConversation()}),n.wR5(23,"ion-icon",10),n.I0R(24,"ion-label"),n.OEk(25,"Save"),n.C$Y()()()()()()()),2&t&&(n.yG2(8),n.E7m("formGroup",a.newConversationForm),n.yG2(5),n.E7m("ngIf",n.kDX(14,4,a.contacts$)),n.yG2(2),n.E7m("ngIf",n.kDX(16,6,a.keys$)),n.yG2(7),n.E7m("disabled",!a.newConversationForm.valid))},dependencies:[_.ay,_.u_,l.sz,l.ot,l.ue,l.u,l.uW,l.Wo,i.sn,i.GS,i.Kk,i._i,i.eV,i.YP,i.wB,i.Ko,i.A5,i.Yb,i.QR,i.qo,i.Cy,i.gd,i.tM,i.Md,i.IT,i.qG,_.a]})}const S=e=>["/conversations",e];function P(e,o){if(1&e){const t=n.KQA();n.I0R(0,"ion-item")(1,"div",10)(2,"div",11),n.OEk(3),n.C$Y(),n.I0R(4,"div",12)(5,"ion-button",13),n.qCj("click",function(){const c=n.usT(t).$implicit,d=n.GaO(3);return n.CGJ(d.deleteConversation(c.id))}),n.wR5(6,"ion-icon",14),n.C$Y()()()()}if(2&e){const t=o.$implicit;n.yG2(2),n.E7m("routerLink",n.S45(2,S,t.id)),n.yG2(),n.oRS(" ",t.name," ")}}function F(e,o){if(1&e&&(n.I0R(0,"ion-list",8),n.yuY(1,P,7,4,"ion-item",9),n.C$Y()),2&e){const t=n.GaO().ngIf;n.yG2(),n.E7m("ngForOf",t)}}const D=()=>["/keys"];function K(e,o){1&e&&(n.I0R(0,"p"),n.OEk(1," If you haven't generated any keys:"),n.wR5(2,"br"),n.I0R(3,"ion-button",17),n.OEk(4,"Generate Keys"),n.C$Y()()),2&e&&(n.yG2(3),n.E7m("routerLink",n.q4q(1,D)))}const H=()=>["/contacts"];function j(e,o){1&e&&(n.I0R(0,"p"),n.OEk(1," If you haven't added any contacts:"),n.wR5(2,"br"),n.I0R(3,"ion-button",17),n.OEk(4,"Add Contacts"),n.C$Y()()),2&e&&(n.yG2(3),n.E7m("routerLink",n.q4q(1,H)))}function Q(e,o){if(1&e&&(n.I0R(0,"div",15)(1,"h2"),n.OEk(2,"No Conversations"),n.C$Y(),n.I0R(3,"p"),n.OEk(4," Conversations store encrypted exchanges between your contacts and any of your keys. "),n.C$Y(),n.I0R(5,"p"),n.OEk(6," To get started, you'll want to make sure you've generated at least one key and shared it with anyone you want to exchange messages with. "),n.C$Y(),n.yuY(7,K,5,2,"p",16),n.wVc(8,"async"),n.yuY(9,j,5,2,"p",16),n.wVc(10,"async"),n.C$Y()),2&e){const t=n.GaO(2);let a,s;n.yG2(7),n.E7m("ngIf",!(null!=(a=n.kDX(8,2,t.keys$))&&a.length)),n.yG2(2),n.E7m("ngIf",!(null!=(s=n.kDX(10,4,t.contacts$))&&s.length))}}function q(e,o){if(1&e&&(n.I0R(0,"div",5),n.yuY(1,F,2,1,"ion-list",6)(2,Q,11,6,"div",7),n.C$Y()),2&e){const t=o.ngIf;n.yG2(),n.E7m("ngIf",t.length),n.yG2(),n.E7m("ngIf",!t.length)}}class C{constructor(o,t,a,s,c){this.keyService=o,this.conversationService=t,this.contactService=a,this.modalController=s,this.routerOutlet=c,this.contacts$=this.contactService.contacts$,this.keys$=this.keyService.keys$,this.conversations$=this.conversationService.conversations$.pipe((0,y.k)(d=>d.sort((u,v)=>u.created-v.created)))}addConversation(){var o=this;return(0,m.c)(function*(){var a;yield(yield o.modalController.create({component:f,canDismiss:(a=(0,m.c)(function*(s,c){return"gesture"!==c}),function(c,d){return a.apply(this,arguments)}),presentingElement:o.routerOutlet.nativeEl})).present()})()}deleteConversation(o){var t=this;return(0,m.c)(function*(){window.confirm("Are you absolutely sure? This is unrecoverable without a backup.")&&t.conversationService.deleteConversation(o)})()}static#n=this.\u0275fac=function(t){return new(t||C)(n.GI1(I.qk),n.GI1(k.eC),n.GI1(G.gH),n.GI1(i.qS),n.GI1(i.Cg))};static#t=this.\u0275cmp=n.In1({type:C,selectors:[["app-home"]],decls:16,vars:3,consts:[["translucent","true"],["color","primary"],["class","conversations",4,"ngIf"],["expand","block",3,"click"],["name","newspaper-outline","slot","start"],[1,"conversations"],["class","conversation-list",4,"ngIf"],["class","conversation-fallback",4,"ngIf"],[1,"conversation-list"],[4,"ngFor","ngForOf"],[1,"conversation-item"],[1,"conversation-name",3,"routerLink"],[1,"buttons"],["color","danger",3,"click"],["name","trash-outline"],[1,"conversation-fallback"],[4,"ngIf"],[3,"routerLink"]],template:function(t,a){1&t&&(n.I0R(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),n.OEk(3," Conversations "),n.C$Y()()(),n.I0R(4,"ion-content"),n.yuY(5,q,3,2,"div",2),n.wVc(6,"async"),n.C$Y(),n.I0R(7,"ion-footer")(8,"ion-toolbar")(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"ion-button",3),n.qCj("click",function(){return a.addConversation()}),n.wR5(13,"ion-icon",4),n.I0R(14,"ion-label"),n.OEk(15,"Start New Conversation"),n.C$Y()()()()()()()),2&t&&(n.yG2(5),n.E7m("ngIf",n.kDX(6,1,a.conversations$)))},dependencies:[_.ay,_.u_,h.ER,i.sn,i.Kk,i._i,i.eV,i.YP,i.wB,i.Ko,i.Yb,i.QR,i.OC,i.qo,i.tM,i.Md,i.mY,_.a],styles:[".conversations[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]{width:100%}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-name[_ngcontent-%COMP%]{flex:1;padding-top:10px;padding-bottom:10px;cursor:pointer}.conversations[_ngcontent-%COMP%]   .conversation-fallback[_ngcontent-%COMP%]{margin:10px;max-width:400px}"]})}class g{static#n=this.\u0275fac=function(t){return new(t||g)};static#t=this.\u0275mod=n.a4G({type:g});static#o=this.\u0275inj=n.s3X({imports:[_.MD,h.qQ.forChild([{path:"",component:C}]),l.y,O.k]})}}}]);