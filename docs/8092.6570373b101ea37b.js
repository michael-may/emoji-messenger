"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8092],{8092:(P,m,r)=>{r.r(m),r.d(m,{SettingsPageModule:()=>g});var f=r(1368),C=r(2324),b=r(4716),E=r(9280),u=r(1528),R=r(9252),w=r(1220),O=r(1876),k=r(1016),e=r(4496),s=r(2112);function Y(l,n){1&l&&e.wR5(0,"ion-spinner",18)}function S(l,n){1&l&&e.wR5(0,"ion-icon",19)}function $(l,n){if(1&l){const t=e.KQA();e.I0R(0,"ion-button",20),e.qCj("click",function(){e.usT(t);const i=e.Gew(5);return e.CGJ(i.click())}),e.wR5(1,"ion-icon",21),e.I0R(2,"ion-label"),e.OEk(3,"Select File"),e.C$Y(),e.I0R(4,"input",22,23),e.qCj("change",function(i){e.usT(t);const p=e.GaO();return e.CGJ(p.import(i))}),e.C$Y()()}}function T(l,n){1&l&&e.wR5(0,"ion-spinner",24)}class d{constructor(n,t,o,i){this.keyService=n,this.contactService=t,this.conversationService=o,this.toastController=i,this.processingBackup=!1,this.processingFile=!1}ngOnDestroy(){}export(){var n=this;return(0,u.c)(function*(){n.processingBackup=!0;const t=window.prompt("Enter a password for this backup (or leave blank).");let o=localStorage.getItem("encryptionKeys")??"",i=localStorage.getItem("contacts")??"",p=localStorage.getItem("conversations")??"";const h=JSON.stringify({encryptionKeys:o,contacts:i,conversations:p}),c=yield k.g.passwordEncrypt(h,t).catch(v=>(console.log(v),null));if(!c)return(yield n.toastController.create({message:"Error encrypting backup.",duration:2e3})).present(),void(n.processingBackup=!1);const I=new Blob([c],{type:"application/messengerbackup"}),a=URL.createObjectURL(I);n.processingBackup=!1;var y=document.createElement("a");y.href=a,y.download=`${Date.now()}.messengerbackup`,y.click()})()}import(n){var t=this;return(0,u.c)(function*(){if(!n.target.files?.length)return;t.processingFile=!0;let o=n?.target?.files?.[0];if(!o)return(yield t.toastController.create({message:"Error loading file.",duration:2e3})).present(),void(t.processingFile=!1);const i=yield t.loadFile(o).catch(a=>(console.log(a),null));if(!i)return(yield t.toastController.create({message:"Error parsing file.",duration:2e3})).present(),void(t.processingFile=!1);const p=window.prompt("Enter the password for this backup (or leave blank if none)."),h=yield k.g.passwordDecrypt(i,p).catch(a=>(console.log(a),null));if(!h)return(yield t.toastController.create({message:"Error decrypting backup. Maybe wrong password?",duration:2e3})).present(),void(t.processingFile=!1);let c;try{c=JSON.parse(h)}catch{return(yield t.toastController.create({message:"Error parsing backup. Probably corrupted.",duration:2e3})).present(),void(t.processingFile=!1)}c.encryptionKeys&&(localStorage.setItem("encryptionKeys",c.encryptionKeys),yield t.keyService.loadKeys().catch(a=>{console.log(a)})),c.contacts&&(localStorage.setItem("contacts",c.contacts),yield t.contactService.loadContacts().catch(a=>{console.log(a)})),c.conversations&&(localStorage.setItem("conversations",c.conversations),yield t.conversationService.loadConversations().catch(a=>{console.log(a)})),t.processingFile=!1,(yield t.toastController.create({message:"Import complete!",duration:2e3})).present()})()}deleteData(){var n=this;return(0,u.c)(function*(){window.confirm("Are you absolutely sure? This is unrecoverable without a backup.")&&(localStorage.clear(),yield n.keyService.loadKeys().catch(o=>{console.log(o)}),yield n.contactService.loadContacts().catch(o=>{console.log(o)}),yield n.conversationService.loadConversations().catch(o=>{console.log(o)}))})()}loadFile(n){return(0,u.c)(function*(){return new Promise((t,o)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.onerror=p=>o(p),i.readAsText(n)})})()}static#e=this.\u0275fac=function(t){return new(t||d)(e.GI1(O.qk),e.GI1(R.gH),e.GI1(w.eC),e.GI1(s.Gq))};static#t=this.\u0275cmp=e.In1({type:d,selectors:[["app-settings"]],decls:87,vars:6,consts:[["translucent","true"],["color","primary"],[3,"disabled","click"],["slot","start",4,"ngIf"],["name","download-outline","slot","start",4,"ngIf"],[3,"click",4,"ngIf"],["slot","end",4,"ngIf"],["color","danger",3,"click"],["name","trash-outline","slot","start"],[3,"multiple"],["value","q1"],["slot","header"],["slot","content"],["value","q2"],["value","q3"],["value","q4"],["href","https://github.com/michael-may/emoji-messenger","target","_blank"],["value","q5"],["slot","start"],["name","download-outline","slot","start"],[3,"click"],["slot","start","name","folder-outline"],["type","file","accept",".messengerbackup","slot","end",1,"ion-hide",3,"change"],["input",""],["slot","end"]],template:function(t,o){1&t&&(e.I0R(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),e.OEk(3," Settings "),e.C$Y()()(),e.I0R(4,"ion-content")(5,"ion-list")(6,"ion-list-header"),e.OEk(7," Your Data "),e.C$Y(),e.I0R(8,"ion-item")(9,"ion-label"),e.OEk(10," Export: "),e.C$Y(),e.I0R(11,"ion-button",2),e.qCj("click",function(){return o.export()}),e.yuY(12,Y,1,0,"ion-spinner",3)(13,S,1,0,"ion-icon",4),e.I0R(14,"ion-label"),e.OEk(15,"Download"),e.C$Y()()(),e.I0R(16,"ion-item")(17,"ion-label"),e.OEk(18," Import Backup: "),e.C$Y(),e.yuY(19,$,6,0,"ion-button",5)(20,T,1,0,"ion-spinner",6),e.C$Y(),e.I0R(21,"ion-item")(22,"ion-label"),e.OEk(23," Delete: "),e.C$Y(),e.I0R(24,"ion-button",7),e.qCj("click",function(){return o.deleteData()}),e.wR5(25,"ion-icon",8),e.I0R(26,"ion-label"),e.OEk(27,"Delete All Data"),e.C$Y()()()(),e.I0R(28,"ion-list-header"),e.OEk(29," Help "),e.C$Y(),e.I0R(30,"ion-accordion-group",9)(31,"ion-accordion",10)(32,"ion-item",11)(33,"p"),e.OEk(34,"Why won't my imported messages load?"),e.C$Y()(),e.I0R(35,"ion-list",12)(36,"p"),e.OEk(37," If you used the image share feature, there's a chance the application you shared to doesn't support transparency or .png files. "),e.C$Y(),e.I0R(38,"p"),e.OEk(39," Try resending the message as a QR code for better compatibility. "),e.C$Y()()(),e.I0R(40,"ion-accordion",13)(41,"ion-item",11)(42,"p"),e.OEk(43,"Why can't I read messages I've sent to other people?"),e.C$Y()(),e.I0R(44,"ion-list",12)(45,"p"),e.OEk(46," Messages sent to other people are encrypted with their public key and are only decryptable with their private key. Since you (hopefully) don't have their private key, you can't read messages you've sent to them. "),e.C$Y(),e.I0R(47,"p"),e.OEk(48," A future update may add the option to save a copy of the message signed with your own key for reference. "),e.C$Y()()(),e.I0R(49,"ion-accordion",14)(50,"ion-item",11)(51,"p"),e.OEk(52,"Why can my messages only contain 382 characters? That seems oddly specific."),e.C$Y()(),e.I0R(53,"ion-list",12)(54,"p"),e.OEk(55," While the output of the message encryption algorithm is 512 bytes long, some of the space is taken up by the message hash. "),e.C$Y(),e.I0R(56,"p"),e.OEk(57," Messages are encrypted with RSA Optimal Asymmetric Encryption Padding (OAEP) using an SHA-512 hash and an RSA 4096 key. The maximum length of your message is the total size (512 bytes) minus the hash overhead (130 bytes). This leaves 382 bytes for your message. "),e.C$Y()()(),e.I0R(58,"ion-accordion",15)(59,"ion-item",11)(60,"p"),e.OEk(61,"Is there a native app available?"),e.C$Y()(),e.I0R(62,"ion-list",12)(63,"p"),e.OEk(64," No. This application is intended to be completely open and unrestricted. "),e.C$Y(),e.I0R(65,"p"),e.OEk(66," The project is built with Angular and Ionic and could be converted to Capacitor application pretty easily. "),e.C$Y(),e.I0R(67,"p")(68,"a",16),e.OEk(69,"Fork and hack away."),e.C$Y()()()(),e.I0R(70,"ion-accordion",17)(71,"ion-item",11)(72,"p"),e.OEk(73,"Can I host my own instance?"),e.C$Y()(),e.I0R(74,"ion-list",12)(75,"p"),e.OEk(76," Feel free to host your own instance! The source code is "),e.I0R(77,"a",16),e.OEk(78,"here"),e.C$Y(),e.OEk(79,". "),e.C$Y(),e.I0R(80,"p"),e.OEk(81," As long as you don't mess with the encryption or image generation functions, your instance should be compatible with any other, similar instance. "),e.C$Y()()()()(),e.I0R(82,"ion-footer")(83,"ion-toolbar")(84,"ion-grid")(85,"ion-row"),e.wR5(86,"ion-col"),e.C$Y()()()()),2&t&&(e.yG2(11),e.E7m("disabled",o.processingBackup),e.yG2(),e.E7m("ngIf",o.processingBackup),e.yG2(),e.E7m("ngIf",!o.processingBackup),e.yG2(6),e.E7m("ngIf",!o.processingFile),e.yG2(),e.E7m("ngIf",o.processingFile),e.yG2(10),e.E7m("multiple",!0))},dependencies:[f.u_,s.cm,s.qU,s.sn,s.Kk,s._i,s.eV,s.YP,s.wB,s.Ko,s.Yb,s.QR,s.OC,s.zz,s.qo,s.YA,s.tM,s.Md],styles:[".full-width[_ngcontent-%COMP%]{width:100%}ion-accordion[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:400px;margin:16px}"]})}class g{static#e=this.\u0275fac=function(t){return new(t||g)};static#t=this.\u0275mod=e.a4G({type:g});static#o=this.\u0275inj=e.s3X({imports:[f.MD,C.qQ.forChild([{path:"",component:d}]),b.sl,E.k]})}}}]);