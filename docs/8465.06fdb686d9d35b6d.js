"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8465],{8465:(j,h,s)=>{s.r(h),s.d(h,{HomePageModule:()=>_});var d=s(9808),C=s(4030),r=s(4182),x=s(4466),g=s(655),Z=s(4850),T=s(9278),A=s(8115),y=s(8790),q=s(6817),k=s(5340),n=s(9863),i=s(5362);function w(t,e){if(1&t&&(n.TgZ(0,"ion-select-option",13),n._uU(1),n.qZA()),2&t){const o=e.$implicit;n.s9C("value",o.id),n.xp6(1),n.hij(" ",o.name," ")}}function I(t,e){if(1&t){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," To: "),n.qZA(),n.TgZ(3,"ion-select",11),n.NdJ("ionChange",function(c){return n.CHM(o),n.oxw(2).updateTo(c)}),n.YNc(4,w,2,2,"ion-select-option",12),n.qZA(),n.BQk()}if(2&t){const o=n.oxw().ngIf;n.xp6(4),n.Q6J("ngForOf",o)}}function M(t,e){if(1&t){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," No saved contacts "),n.qZA(),n.TgZ(3,"ion-button",3),n.NdJ("click",function(){return n.CHM(o),n.oxw(2).addContact()}),n._uU(4,"Add Contact"),n.qZA(),n.BQk()}}function N(t,e){if(1&t&&(n.TgZ(0,"ion-item"),n.YNc(1,I,5,1,"ng-container",8),n.YNc(2,M,5,0,"ng-container",8),n.qZA()),2&t){const o=e.ngIf;n.xp6(1),n.Q6J("ngIf",o.length),n.xp6(1),n.Q6J("ngIf",!o.length)}}function J(t,e){if(1&t&&(n.TgZ(0,"ion-select-option",13),n._uU(1),n.qZA()),2&t){const o=e.$implicit;n.Q6J("value",o.id),n.xp6(1),n.hij(" ",o.name," ")}}function b(t,e){if(1&t){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," From: "),n.qZA(),n.TgZ(3,"ion-select",14),n.NdJ("ionChange",function(c){return n.CHM(o),n.oxw(2).updateFrom(c)}),n.YNc(4,J,2,2,"ion-select-option",12),n.qZA(),n.BQk()}if(2&t){const o=n.oxw().ngIf;n.xp6(4),n.Q6J("ngForOf",o)}}function U(t,e){if(1&t){const o=n.EpF();n.ynx(0),n.TgZ(1,"ion-label"),n._uU(2," No saved keys "),n.qZA(),n.TgZ(3,"ion-button",3),n.NdJ("click",function(){return n.CHM(o),n.oxw(2).createKey()}),n._uU(4,"Create Key"),n.qZA(),n.BQk()}}function Y(t,e){if(1&t&&(n.TgZ(0,"ion-item"),n.YNc(1,b,5,1,"ng-container",8),n.YNc(2,U,5,0,"ng-container",8),n.qZA()),2&t){const o=e.ngIf;n.xp6(1),n.Q6J("ngIf",o.length),n.xp6(1),n.Q6J("ngIf",!o.length)}}class v{constructor(e,o,a,c,l){this.conversationService=e,this.keyService=o,this.contactService=a,this.modalController=c,this.elementRef=l,this.contacts$=this.contactService.contacts$.pipe((0,Z.U)(m=>m.sort((p,f)=>p.created-f.created))),this.keys$=this.keyService.keys$.pipe((0,Z.U)(m=>m.sort((p,f)=>p.created-f.created))),this.newConversationForm=new r.cw({name:new r.NI("",r.kI.required),to:new r.NI("",r.kI.required),from:new r.NI("",r.kI.required)}),this.saving=!1}addContact(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:q.S,swipeToClose:!0,presentingElement:this.elementRef.nativeElement})).present()})}createKey(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:k.K,swipeToClose:!0,presentingElement:this.elementRef.nativeElement})).present()})}saveConversation(){return(0,g.mG)(this,void 0,void 0,function*(){if(this.saving)return;this.saving=!0;const e=this.newConversationForm.get("name").value,o=this.newConversationForm.get("to").value,a=this.newConversationForm.get("from").value,c=yield this.conversationService.addConversation(e,o,a).catch(l=>(console.log(l),null));if(this.saving=!1,!c)throw new Error("Couldn't create conversation.");this.dismiss()})}updateTo(e){var o;this.newConversationForm.patchValue({to:null===(o=e.detail)||void 0===o?void 0:o.value})}updateFrom(e){var o;this.newConversationForm.patchValue({from:null===(o=e.detail)||void 0===o?void 0:o.value})}dismiss(){this.modalController.dismiss()}}v.\u0275fac=function(e){return new(e||v)(n.Y36(T.EA),n.Y36(A.BA),n.Y36(y.yq),n.Y36(i.IN),n.Y36(n.SBq))},v.\u0275cmp=n.Xpm({type:v,selectors:[["app-conversation-add"]],decls:26,vars:8,consts:[["translucent","true"],["color","primary"],["slot","primary"],[3,"click"],["slot","icon-only","name","close"],[3,"formGroup"],["position","floating"],["formControlName","name","ngDefaultControl","","placeholder","Name","type","text"],[4,"ngIf"],["expand","block",3,"disabled","click"],["name","save-outline","slot","start"],["formControlName","to","ngDefaultControl","","placeholder","Select a Contact",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formControlName","from","ngDefaultControl","","placeholder","Select a Key",3,"ionChange"]],template:function(e,o){1&e&&(n.TgZ(0,"ion-header",0),n.TgZ(1,"ion-toolbar",1),n.TgZ(2,"ion-title"),n._uU(3," Create new Conversation "),n.qZA(),n.TgZ(4,"ion-buttons",2),n.TgZ(5,"ion-button",3),n.NdJ("click",function(){return o.dismiss()}),n._UZ(6,"ion-icon",4),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(7,"ion-content"),n.TgZ(8,"form",5),n.TgZ(9,"ion-item"),n.TgZ(10,"ion-label",6),n._uU(11," Conversation Name "),n.qZA(),n._UZ(12,"ion-input",7),n.qZA(),n.YNc(13,N,3,2,"ion-item",8),n.ALo(14,"async"),n.YNc(15,Y,3,2,"ion-item",8),n.ALo(16,"async"),n.qZA(),n.qZA(),n.TgZ(17,"ion-footer"),n.TgZ(18,"ion-toolbar"),n.TgZ(19,"ion-grid"),n.TgZ(20,"ion-row"),n.TgZ(21,"ion-col"),n.TgZ(22,"ion-button",9),n.NdJ("click",function(){return o.saveConversation()}),n._UZ(23,"ion-icon",10),n.TgZ(24,"ion-label"),n._uU(25,"Save"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(8),n.Q6J("formGroup",o.newConversationForm),n.xp6(5),n.Q6J("ngIf",n.lcZ(14,4,o.contacts$)),n.xp6(2),n.Q6J("ngIf",n.lcZ(16,6,o.keys$)),n.xp6(7),n.Q6J("disabled",!o.newConversationForm.valid))},directives:[i.Gu,i.sr,i.wd,i.Sm,i.YG,i.gu,i.W2,r._Y,r.JL,r.sg,i.Ie,i.Q$,i.pK,i.j9,r.JJ,r.u,r.Fj,d.O5,i.fr,i.jY,i.Nd,i.wI,i.t9,i.QI,d.sg,i.n0],pipes:[d.Ov],styles:[""]});const F=function(t){return["/conversations",t]};function P(t,e){if(1&t){const o=n.EpF();n.TgZ(0,"ion-item"),n.TgZ(1,"div",10),n.TgZ(2,"div",11),n._uU(3),n.qZA(),n.TgZ(4,"div",12),n.TgZ(5,"ion-button",13),n.NdJ("click",function(){const l=n.CHM(o).$implicit;return n.oxw(3).deleteConversation(l.id)}),n._UZ(6,"ion-icon",14),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const o=e.$implicit;n.xp6(2),n.Q6J("routerLink",n.VKq(2,F,o.id)),n.xp6(1),n.hij(" ",o.name," ")}}function Q(t,e){if(1&t&&(n.TgZ(0,"ion-list",8),n.YNc(1,P,7,4,"ion-item",9),n.qZA()),2&t){const o=n.oxw().ngIf;n.xp6(1),n.Q6J("ngForOf",o)}}const O=function(){return["/keys"]};function S(t,e){1&t&&(n.TgZ(0,"p"),n._uU(1," If you haven't generated any keys:"),n._UZ(2,"br"),n.TgZ(3,"ion-button",17),n._uU(4,"Generate Keys"),n.qZA(),n.qZA()),2&t&&(n.xp6(3),n.Q6J("routerLink",n.DdM(1,O)))}const $=function(){return["/contacts"]};function H(t,e){1&t&&(n.TgZ(0,"p"),n._uU(1," If you haven't added any contacts:"),n._UZ(2,"br"),n.TgZ(3,"ion-button",17),n._uU(4,"Add Contacts"),n.qZA(),n.qZA()),2&t&&(n.xp6(3),n.Q6J("routerLink",n.DdM(1,$)))}function E(t,e){if(1&t&&(n.TgZ(0,"div",15),n.TgZ(1,"h2"),n._uU(2,"No Conversations"),n.qZA(),n.TgZ(3,"p"),n._uU(4," Conversations store encrypted exchanges between your contacts and any of your keys. "),n.qZA(),n.TgZ(5,"p"),n._uU(6," To get started, you'll want to make sure you've generated at least one key and shared it with anyone you want to exchange messages with. "),n.qZA(),n.YNc(7,S,5,2,"p",16),n.ALo(8,"async"),n.YNc(9,H,5,2,"p",16),n.ALo(10,"async"),n.qZA()),2&t){const o=n.oxw(2);let a,c;n.xp6(7),n.Q6J("ngIf",!(null!=(a=n.lcZ(8,2,o.keys$))&&a.length)),n.xp6(2),n.Q6J("ngIf",!(null!=(c=n.lcZ(10,4,o.contacts$))&&c.length))}}function G(t,e){if(1&t&&(n.TgZ(0,"div",5),n.YNc(1,Q,2,1,"ion-list",6),n.YNc(2,E,11,6,"div",7),n.qZA()),2&t){const o=e.ngIf;n.xp6(1),n.Q6J("ngIf",o.length),n.xp6(1),n.Q6J("ngIf",!o.length)}}class u{constructor(e,o,a,c,l){this.keyService=e,this.conversationService=o,this.contactService=a,this.modalController=c,this.routerOutlet=l,this.contacts$=this.contactService.contacts$,this.keys$=this.keyService.keys$,this.conversations$=this.conversationService.conversations$.pipe((0,Z.U)(m=>m.sort((p,f)=>p.created-f.created)))}addConversation(){return(0,g.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:v,swipeToClose:!0,presentingElement:this.routerOutlet.nativeEl})).present()})}deleteConversation(e){return(0,g.mG)(this,void 0,void 0,function*(){window.confirm("Are you absolutely sure? This is unrecoverable without a backup.")&&this.conversationService.deleteConversation(e)})}}u.\u0275fac=function(e){return new(e||u)(n.Y36(A.BA),n.Y36(T.EA),n.Y36(y.yq),n.Y36(i.IN),n.Y36(i.jP))},u.\u0275cmp=n.Xpm({type:u,selectors:[["app-home"]],decls:16,vars:3,consts:[["translucent","true"],["color","primary"],["class","conversations",4,"ngIf"],["expand","block",3,"click"],["name","newspaper-outline","slot","start"],[1,"conversations"],["class","conversation-list",4,"ngIf"],["class","conversation-fallback",4,"ngIf"],[1,"conversation-list"],[4,"ngFor","ngForOf"],[1,"conversation-item"],[1,"conversation-name",3,"routerLink"],[1,"buttons"],["color","danger",3,"click"],["name","trash-outline"],[1,"conversation-fallback"],[4,"ngIf"],[3,"routerLink"]],template:function(e,o){1&e&&(n.TgZ(0,"ion-header",0),n.TgZ(1,"ion-toolbar",1),n.TgZ(2,"ion-title"),n._uU(3," Conversations "),n.qZA(),n.qZA(),n.qZA(),n.TgZ(4,"ion-content"),n.YNc(5,G,3,2,"div",2),n.ALo(6,"async"),n.qZA(),n.TgZ(7,"ion-footer"),n.TgZ(8,"ion-toolbar"),n.TgZ(9,"ion-grid"),n.TgZ(10,"ion-row"),n.TgZ(11,"ion-col"),n.TgZ(12,"ion-button",3),n.NdJ("click",function(){return o.addConversation()}),n._UZ(13,"ion-icon",4),n.TgZ(14,"ion-label"),n._uU(15,"Start New Conversation"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(5),n.Q6J("ngIf",n.lcZ(6,1,o.conversations$)))},directives:[i.Gu,i.sr,i.wd,i.W2,d.O5,i.fr,i.jY,i.Nd,i.wI,i.YG,i.gu,i.Q$,i.q_,d.sg,i.Ie,C.rH,i.YI],pipes:[d.Ov],styles:[".conversations[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]{width:100%}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.conversations[_ngcontent-%COMP%]   .conversation-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-name[_ngcontent-%COMP%]{flex:1;padding-top:10px;padding-bottom:10px;cursor:pointer}.conversations[_ngcontent-%COMP%]   .conversation-fallback[_ngcontent-%COMP%]{margin:10px;max-width:400px}"]});class _{}_.\u0275fac=function(e){return new(e||_)},_.\u0275mod=n.oAB({type:_}),_.\u0275inj=n.cJS({imports:[[d.ez,C.Bz.forChild([{path:"",component:u}]),r.u5,x.m]]})}}]);